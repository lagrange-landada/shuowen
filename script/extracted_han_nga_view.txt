select `t`.`id` AS `id`,`t`.`shuowen_fk_word_id` AS `shuowen_fk_word_id`,`t`.`shuowen_fk_word_real_id` AS `shuowen_fk_word_real_id`,`t`.`word` AS `word`,`t`.`word_real` AS `word_real`,`t`.`definition` AS `definition`,`t`.`note` AS `note`,`t`.`flag` AS `flag`,`t`.`volume` AS `volume`,substring_index(substring_index(`t`.`word`,';',`n`.`n`),';',-(1)) AS `extracted_word`,substring_index(substring_index(`t`.`word_real`,';',find_in_set(`n`.`n`,replace(`t`.`flag`,';',','))),';',-(1)) AS `extracted_word_real`,`t`.`source` AS `source`,substring_index(substring_index(`t`.`shuowen_fk_word_id`,';',`n`.`n`),';',-(1)) AS `extracted_shuowen_fk_word_id`,substring_index(substring_index(`t`.`shuowen_fk_word_real_id`,';',find_in_set(`n`.`n`,replace(`t`.`flag`,';',','))),';',-(1)) AS `extracted_shuowen_fk_word_real_id` from (`shuowen`.`t_han_nga` `t` left join (select 1 AS `n` union select 2 AS `2` union select 3 AS `3` union select 4 AS `4` union select 5 AS `5` union select 6 AS `6` union select 7 AS `7` union select 8 AS `8` union select 9 AS `9` union select 10 AS `10` union select 11 AS `11` union select 12 AS `12` union select 13 AS `13` union select 14 AS `14` union select 15 AS `15` union select 16 AS `16` union select 17 AS `17` union select 18 AS `18` union select 19 AS `19` union select 20 AS `20`) `n` on((find_in_set(`n`.`n`,replace(`t`.`flag`,';',',')) > 0))) order by `t`.`id`,`n`.`n`